<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Logging honeypots with BigQuery | eeubanks</title><meta name=keywords content="TBD,TBD"><meta name=description content="Ingesting honeypot logs on GCP"><meta name=author content="eeubanks"><link rel=canonical href=/posts/008-forwarding-honeypot-logs/><link href=/assets/css/stylesheet.min.2a79645f388444ef452f62dadbadeebdfebba13b08d1b841a7504a7be022e74d.css integrity="sha256-KnlkXziERO9FL2La263uvf67oTsI0bhBp1BKe+Ai500=" rel="preload stylesheet" as=style><link rel=icon href=/coffeaarabica400x400.png><link rel=icon type=image/png sizes=16x16 href=/coffeaarabica400x400.png><link rel=icon type=image/png sizes=32x32 href=/coffeaarabica400x400.png><link rel=apple-touch-icon href=/coffeaarabica400x400.png><link rel=mask-icon href=/coffeaarabica400x400.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><meta property="og:title" content="Logging honeypots with BigQuery"><meta property="og:description" content="Ingesting honeypot logs on GCP"><meta property="og:type" content="article"><meta property="og:url" content="/posts/008-forwarding-honeypot-logs/"><meta property="og:image" content="/img/005-logs01.png"><meta property="article:published_time" content="2021-01-29T00:00:03+00:00"><meta property="article:modified_time" content="2021-01-29T00:00:03+00:00"><meta property="og:site_name" content="eeubanks"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/005-logs01.png"><meta name=twitter:title content="Logging honeypots with BigQuery"><meta name=twitter:description content="Ingesting honeypot logs on GCP"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Logging honeypots with BigQuery","name":"Logging honeypots with BigQuery","description":"The first honeypot I ever ran was a Cowrie honeypot on Azure. I checked in on the honeypot for about 3 days, there were no abnormalities. After this point, I left the machine alone …","keywords":["TBD","TBD"],"articleBody":"The first honeypot I ever ran was a Cowrie honeypot on Azure. I checked in on the honeypot for about 3 days, there were no abnormalities. After this point, I left the machine alone for about a month, where I returned to approximately 4 days of logs. My honeypot was getting SLAMMED with activity but because I wasn’t rotating my logs I wasn’t able to properly save it. In this post I’ll be walking through the process of forwarding one of my honeypot logs to stackdriver for collection.\nPlanning Log Collection The honeynet will be small in an effort to keep the cost of this experiement low. Sending and storing logs will be added costs. Taking cost into account, the log collection strategy will be minimalist.\nThe use-case of honeypot log collection is to observe malicious behavioral patterns. For this reason, you may choose to only forward intelligence gathered by the honeypot. However, within the context of an enterprise, an administrator may wish to also monitor the health of the honeypot host in order to ensure the integrity and availability of data.\nData retention is additional consideration. Again, in the context of an enterprise data retention policies may apply. Consider the type of data being stored and the frequency with which it will be queried. This will impact the type of storage used and cost (i.e. hot vs. cold storage).\nWe will batch load the files because we are not interested\n ","wordCount":"241","inLanguage":"en","image":"/img/005-logs01.png","datePublished":"2021-01-29T00:00:03Z","dateModified":"2021-01-29T00:00:03Z","author":{"@type":"Person","name":"eeubanks"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/008-forwarding-honeypot-logs/"},"publisher":{"@type":"Organization","name":"eeubanks","logo":{"@type":"ImageObject","url":"/coffeaarabica400x400.png"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=/ accesskey=h title="EE (Alt + H)"><img src=coffeaarabica400x400.png alt=logo aria-label=logo height=35>EE</a>
<span class=logo-switches><span class=theme-toggle title="(Alt + T)"><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=/posts/ title=POSTS><span>POSTS</span></a></li><li><a href=/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=/ title=HOME><span>HOME</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Logging honeypots with BigQuery</h1><div class=post-description>Ingesting honeypot logs on GCP</div><div class=post-meta>January 29, 2021&nbsp;·&nbsp;2 min&nbsp;·&nbsp;eeubanks</div></header><figure class=entry-cover><img src=/img/005-logs01.png alt=TBD><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><blockquote><ul><li><a href=#planning-log-collection aria-label="Planning Log Collection">Planning Log Collection</a></li></ul></blockquote></details></div><div class=post-content><p>The first honeypot I ever ran was a Cowrie honeypot on Azure. I checked in on the honeypot for about 3 days, there were no abnormalities. After this point, I left the machine alone for about a month, where I returned to approximately 4 days of logs. My honeypot was getting SLAMMED with activity but because I wasn&rsquo;t rotating my logs I wasn&rsquo;t able to properly save it. In this post I&rsquo;ll be walking through the process of forwarding one of my honeypot logs to stackdriver for collection.</p><h2 id=planning-log-collection>Planning Log Collection<a hidden class=anchor aria-hidden=true href=#planning-log-collection>#</a></h2><p>The honeynet will be small in an effort to keep the cost of this experiement low. Sending and storing logs will be added costs. Taking cost into account, the log collection strategy will be <a href=https://docs.graylog.org/en/4.0/pages/getting_started/planning.html>minimalist</a>.</p><p>The use-case of honeypot log collection is to observe malicious behavioral patterns. For this reason, you may choose to only forward intelligence gathered by the honeypot. However, within the context of an enterprise, an administrator may wish to also monitor the health of the honeypot host in order to ensure the integrity and availability of data.</p><p>Data retention is additional consideration. Again, in the context of an enterprise data retention policies may apply. Consider the type of data being stored and the frequency with which it will be queried. This will impact the type of storage used and cost (i.e. hot vs. cold storage).</p><p>We will batch load the files because we are not interested</p><h2 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/tbd/>TBD</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=/>eeubanks</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>