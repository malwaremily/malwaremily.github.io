<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Honeypots in the Cloud 101 | coffeefolia</title><meta name=keywords content="honeypot,Go,SSH,analysis,GCP,tutorial,HoneyTrap,Docker"><meta name=description content="A Honeypot on GCP Tutorial Using HoneyTrap"><meta name=author content="Emily Eubanks"><link rel=canonical href=/posts/005-honeytrap/><link href=/assets/css/stylesheet.min.2a79645f388444ef452f62dadbadeebdfebba13b08d1b841a7504a7be022e74d.css integrity="sha256-KnlkXziERO9FL2La263uvf67oTsI0bhBp1BKe+Ai500=" rel="preload stylesheet" as=style><link rel=icon href=/coffeaarabica400x400.png><link rel=icon type=image/png sizes=16x16 href=/coffeaarabica400x400.png><link rel=icon type=image/png sizes=32x32 href=/coffeaarabica400x400.png><link rel=apple-touch-icon href=/coffeaarabica400x400.png><link rel=mask-icon href=/coffeaarabica400x400.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><meta property="og:title" content="Honeypots in the Cloud 101"><meta property="og:description" content="A Honeypot on GCP Tutorial Using HoneyTrap"><meta property="og:type" content="article"><meta property="og:url" content="/posts/005-honeytrap/"><meta property="og:image" content="/img/005-logs.png"><meta property="article:published_time" content="2021-01-25T00:00:03+00:00"><meta property="article:modified_time" content="2021-01-25T00:00:03+00:00"><meta property="og:site_name" content="coffeefolia"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/img/005-logs.png"><meta name=twitter:title content="Honeypots in the Cloud 101"><meta name=twitter:description content="A Honeypot on GCP Tutorial Using HoneyTrap"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Honeypots in the Cloud 101","name":"Honeypots in the Cloud 101","description":"Overview Honeypots are useful tools for collecting unauthorized interactions as logs. These logs can be digested to identify new attacking techniques or observe active …","keywords":["honeypot","Go","SSH","analysis","GCP","tutorial","HoneyTrap","Docker"],"articleBody":"Overview Honeypots are useful tools for collecting unauthorized interactions as logs. These logs can be digested to identify new attacking techniques or observe active username/password patterns. In the context of a security team, it could provide actionable information to pre-emptively secure the studied environment.\nThis tutorial will discuss general SSH honeypot pre-configuration, HoneyTrap installation, logging, and analysis. A docker continer is used to launch a low interaction SSH honeypot HoneyTrap. Check out the HoneyTrap documentation for more information about HoneyTrap and what HoneyTrap can do.\nPre-Configuration The honeypot workstation for this tutorial is GCP e2-micro instance running Ubuntu 16.04 LTS.\nSSH Service To log unauthorized interactions with the SSH service the default port 22 will be used by the fake honeypot service. The real SSH service will need to be moved to another port. For this tutorial port 1025 is used.\nFirst change the SSH service port number by editing sshd_config.\nsudo vim /etc/ssh/sshd_config Where the file reads…\n# What ports, IPs, and protocols we listen for …change Port 22 to Port 1025 and uncomment ListenAddress 0.0.0.0 and ListenAddress :: as shown below.\nRestart the ssh service with systemctl and verify SSH daemon is listening on port 1025 with aa -an | grep PORT_NUM.\n$ sudo systemctl restart ssh $ ss -an | grep 1025 tcp LISTEN 0 128 *:1025 *:* tcp LISTEN 0 128 :::1025 :::* Firewall Changes Use ufw to open up the new port for the SSH service.\n$ sudo ufw allow 1025/tcp Rules updated Rules updated (v6) Now go to the GCP console and navigate to the firewall for the managed instance. In the firewall rule table, click on the name “default-allow-ssh”  Edit. Navigate to “Protocols and Ports” and change the specified port from 22 to the desired port number, we’ll use port 1025 for this example.\nNow add another rule for wild traffic on port 22. You should now be able to login from the custom port 1025 and honeypot traffic should be able to communicate out port 22.\nReturn to the honeypot instance. If you are SSH-ing in from the console, use the drop-down selector and choose “Open in browser window on custom port” to login using port 1025.\nInstall Docker Almost done with pre-configuration. Finally, install docker.\nHoneypot Installation At this point you should be able to install and run any functioning docker honeypot on port 22. We are using HoneyTrap for this tutorial because of ease of installation: you can pull the container and run it on port 22 with this command:\nsudo docker run -p 22:8022 HoneyTrap/HoneyTrap:latest Observing traffic Verify this honeypot is running by attempting to login from a remote client. As HoneyTrap runs on the GCP host, custom verbose debug logs are generated and printed to stdout. When an interaction is detected a log is created to record the behavior, otherwise periodically a heartbeat is logged to confirm to the operator the honeypot is alive and listening.\nPassword Guessing We can see an example of password gueesing in the log snippet below. IP 113.128.246.50 attempts to login to HoneyTrap over port 22 using the password adminbigdata:\nAfter successfully guessing or cracking the HoneyTrap login credentials (username=\"root\" password “password\") the attacker will see the following fake Ubuntu prompt.\nAny attempted commands appear in the logs character by character. An exit command would appear in the logs as:\nLogging Behaviors In another example, the value ssh.exec[] stores the movements of an attacker from source ip 71.214.59.235 sending exec commands over ssh (without logging in). They send 9 commands before realizing they are in a honeypot, at which point they say hello before disconnecting. Below you can see a screenshot of the logs storing ssh.exec[] values and then the entered commands in plaintext.\n/ip cloud print ifconfig uname -a cat /proc/cpuinfo ps | grep '[Mm]iner' ls -la /dev/ttyGSM* /dev/ttyUSB-mod* /var/spool/sms/* /var/log/smsd.log /etc/smsd.conf* /usr/bin/qmuxd /var/qmux_connect_socket /etc/config/simman /dev/modem* /var/config/sms/* echo Hi | cat -n Analysis To collect information from docker, output the logs to a text file and move the text file to another workstation for log ingestion and analysis.\nsudo docker logs CONTAINER_NAME  OUTPUTFILE.txt Here are some commands you can use to manually parse the log for actionable infomation. To understand the parsing context, a log sample is provided:\nSAMPLE LOG: services  ssh  category=ssh, date=2021-01-24 19:55:03.026780504 +0000 UTC m=+2451.851735112, destination-ip=172.17.0.2, destination-port=8022, sensor=services, source-ip=125.75.150.251, source-port=37014, ssh.password=P@$$woRD!, ssh.sessionid=c06t1500f8ng00eauvog, ssh.username=root, token=c06se0o0f8ng00eauvm0, type=password-authentication IP SOURCE ADDRESSES $egrep -ao 'source-ip=\\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b' infile.txt source-ip=183.230.91.108 source-ip=81.69.20.76 source-ip=71.206.158.143 source-ip=125.75.150.251 source-ip=45.155.205.87 source-ip=45.155.205.87 source-ip=45.155.205.87 source-ip=138.68.24.88 source-ip=71.214.59.235 source-ip=71.214.59.235 source-ip=71.214.59.235 source-ip=71.214.59.235 source-ip=71.214.59.235 source-ip=71.214.59.235 source-ip=71.214.59.235 SOURCE IP \u0026 COMMAND REQUESTS $egrep -ao 'source-ip=\\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b|ssh.exec=\\[\\]string(.*)\\\"}' infile.txt source-ip=71.214.59.235 ssh.exec=[]string{\"/ip cloud print\"} source-ip=71.214.59.235 ssh.exec=[]string{\"ifconfig\"} source-ip=71.214.59.235 ssh.exec=[]string{\"uname -a\"} source-ip=71.214.59.235 ssh.exec=[]string{\"cat /proc/cpuinfo\"} source-ip=71.214.59.235 ssh.exec=[]string{\"ps | grep '[Mm]iner'\"} source-ip=71.214.59.235 ssh.exec=[]string{\"ps -ef | grep '[Mm]iner'\"} source-ip=71.214.59.235 ssh.exec=[]string{\"ls -la /dev/ttyGSM* /dev/ttyUSB-mod* /var/spool/sms/* /var/log/smsd.log /etc/smsd.conf* /usr/bin/qmuxd /var/qmux_connect_socket /etc/config/simman /dev/modem* /var/config/sms/*\"} source-ip=71.214.59.235 ssh.exec=[]string{\"echo Hi | cat -n\"} USERNAME/PASSWORD COMBINATIONS $egrep -ao 'ssh.username=([0-9-]*|[A-Z]*|[a-z]*)|ssh.password=([0-9-]*|[A-Z]*|[a-z]*)' infile.txt ssh.username=user ssh.password=adminroute ssh.username=root ssh.password=123 ssh.username=root ssh.password=huangzupei ssh.username=root ssh.password=raspberry ssh.username=pi ssh.password=raspberryraspberry ssh.username=root ssh.password=paxsword ssh.username=root ssh.password=passsword ssh.username=root ssh.password=password Final Thoughts Hosting honeypots on cloud architecture enables security researchers to quickly experiement without endangering local networks. It is not without its own considerations, the researcher should monitor and secure the research workstation and have a plan in the event of compromise. Open-source honeypots are commonly criticized for being easy to detect, evade, and come with security vulnerabilities of their own. In additon to making a plan for the honeypot lifecycle, make a plan for log collection and ingestion to automate log analysis and data visualization.\nOpSec Additionally, the default username of the cloud machine will be the username of the gmail address used by GCP. A researcher using firstnameLastname@gmail[dot]com may allow an attacker to identify the first and last name of the researcher. This can be mitigated by adding a new user to the honeypot and removing the old firstnameLastname user. Usernames associated with social media account present similar concerns. Note also at the time of compute instance creation, the hostname set in the networking section defaults to HOSTNAME.REGION.PROJECT_NAME.internal where PROJECT_NAME and hosting region are exposed.\n","wordCount":"1002","inLanguage":"en","image":"/img/005-logs.png","datePublished":"2021-01-25T00:00:03Z","dateModified":"2021-01-25T00:00:03Z","author":{"@type":"Person","name":"Emily Eubanks"},"mainEntityOfPage":{"@type":"WebPage","@id":"/posts/005-honeytrap/"},"publisher":{"@type":"Organization","name":"coffeefolia","logo":{"@type":"ImageObject","url":"/coffeaarabica400x400.png"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=/ accesskey=h title="(Alt + H)"><img src=coffeaarabica400x400.png alt=logo aria-label=logo height=35></a>
<span class=logo-switches><span class=theme-toggle title="(Alt + T)"><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=/posts/ title=POSTS><span>POSTS</span></a></li><li><a href=/tags/ title=TAGS><span>TAGS</span></a></li><li><a href=/ title=HOME><span>HOME</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Honeypots in the Cloud 101</h1><div class=post-description>A Honeypot on GCP Tutorial Using HoneyTrap</div><div class=post-meta>January 25, 2021&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Emily Eubanks</div></header><figure class=entry-cover><img src=/img/005-logs.png alt="HoneyTrap Logs"><p></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><blockquote><ul><li><a href=#overview aria-label=Overview>Overview</a></li><li><a href=#pre-configuration aria-label=Pre-Configuration>Pre-Configuration</a><ul><li><a href=#ssh-service aria-label="SSH Service">SSH Service</a></li><li><a href=#firewall-changes aria-label="Firewall Changes">Firewall Changes</a></li><li><a href=#install-docker aria-label="Install Docker">Install Docker</a></li></ul></li><li><a href=#honeypot-installation aria-label="Honeypot Installation">Honeypot Installation</a><ul><li><a href=#observing-traffic aria-label="Observing traffic">Observing traffic</a></li><li><a href=#password-guessing aria-label="Password Guessing">Password Guessing</a></li><li><a href=#logging-behaviors aria-label="Logging Behaviors">Logging Behaviors</a></li></ul></li><li><a href=#analysis aria-label=Analysis>Analysis</a><ul><ul><li><a href=#ip-source-addresses aria-label="IP SOURCE ADDRESSES">IP SOURCE ADDRESSES</a></li><li><a href=#source-ip--command-requests aria-label="SOURCE IP &amp;amp; COMMAND REQUESTS">SOURCE IP & COMMAND REQUESTS</a></li><li><a href=#usernamepassword-combinations aria-label="USERNAME/PASSWORD COMBINATIONS">USERNAME/PASSWORD COMBINATIONS</a></li></ul></ul></li><li><a href=#final-thoughts aria-label="Final Thoughts">Final Thoughts</a><ul><ul><li><a href=#opsec aria-label=OpSec>OpSec</a></li></ul></ul></li></ul></blockquote></details></div><div class=post-content><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Honeypots are useful tools for collecting unauthorized interactions as logs. These logs can be digested to identify new attacking techniques or observe active username/password patterns. In the context of a security team, it could provide actionable information to pre-emptively secure the studied environment.</p><p>This tutorial will discuss general SSH honeypot pre-configuration, <code>HoneyTrap</code> installation, logging, and analysis. A <a href=https://hub.docker.com/r/HoneyTrap/HoneyTrap/>docker continer</a> is used to launch a low interaction SSH honeypot <code>HoneyTrap</code>. Check out the <a href=https://docs.HoneyTrap.io/manuals/>HoneyTrap documentation</a> for more information about <code>HoneyTrap</code> and what <code>HoneyTrap</code> can do.</p><h2 id=pre-configuration>Pre-Configuration<a hidden class=anchor aria-hidden=true href=#pre-configuration>#</a></h2><p>The honeypot workstation for this tutorial is GCP e2-micro instance running Ubuntu 16.04 LTS.</p><h3 id=ssh-service>SSH Service<a hidden class=anchor aria-hidden=true href=#ssh-service>#</a></h3><p>To log unauthorized interactions with the SSH service the default port 22 will be used by the fake honeypot service. The real SSH service will need to be moved to another port. For this tutorial <code>port 1025</code> is used.</p><p>First change the SSH service port number by editing <code>sshd_config</code>.</p><pre><code>sudo vim /etc/ssh/sshd_config
</code></pre><p>Where the file reads&mldr;</p><pre><code># What ports, IPs, and protocols we listen for
</code></pre><p>&mldr;change <code>Port 22</code> to <code>Port 1025</code> and uncomment <code>ListenAddress 0.0.0.0</code> and <code>ListenAddress ::</code> as shown below.</p><p><img src=/img/005-sshdconfig.png alt=sshdconfig></p><p>Restart the ssh service with <code>systemctl</code> and verify SSH daemon is listening on port 1025 with <code>aa -an | grep PORT_NUM</code>.</p><pre><code>$ sudo systemctl restart ssh
$ ss -an | grep 1025
tcp    LISTEN     0      128       *:1025                  *:*                  
tcp    LISTEN     0      128      :::1025                 :::*
</code></pre><h3 id=firewall-changes>Firewall Changes<a hidden class=anchor aria-hidden=true href=#firewall-changes>#</a></h3><p>Use <code>ufw</code> to open up the new port for the SSH service.</p><pre><code>$ sudo ufw allow 1025/tcp
Rules updated
Rules updated (v6)
</code></pre><p>Now go to the GCP console and navigate to the firewall for the managed instance. In the firewall rule table, click on the name &ldquo;default-allow-ssh&rdquo; > Edit. Navigate to &ldquo;Protocols and Ports&rdquo; and change the specified port from 22 to the desired port number, we&rsquo;ll use port 1025 for this example.</p><p>Now add another rule for wild traffic on port 22. You should now be able to login from the custom port 1025 and honeypot traffic should be able to communicate out port 22.</p><p><img src=/img/005-firewall.png alt="GCP Firewall Rules"></p><p>Return to the honeypot instance. If you are SSH-ing in from the console, use the drop-down selector and choose &ldquo;Open in browser window on custom port&rdquo; to login using port <code>1025</code>.</p><h3 id=install-docker>Install Docker<a hidden class=anchor aria-hidden=true href=#install-docker>#</a></h3><p>Almost done with pre-configuration. Finally, <a href=https://docs.docker.com/engine/install/ubuntu/>install docker</a>.</p><h2 id=honeypot-installation>Honeypot Installation<a hidden class=anchor aria-hidden=true href=#honeypot-installation>#</a></h2><p>At this point you should be able to install and run any functioning docker honeypot on port 22. We are using <code>HoneyTrap</code> for this tutorial because of ease of installation: you can pull the container and run it on port 22 with this command:</p><pre><code>sudo docker run -p 22:8022 HoneyTrap/HoneyTrap:latest
</code></pre><h3 id=observing-traffic>Observing traffic<a hidden class=anchor aria-hidden=true href=#observing-traffic>#</a></h3><p>Verify this honeypot is running by attempting to login from a remote client. As <code>HoneyTrap</code> runs on the GCP host, custom verbose debug logs are generated and printed to <code>stdout</code>. When an interaction is detected a log is created to record the behavior, otherwise periodically a heartbeat is logged to confirm to the operator the honeypot is alive and listening.</p><p><img src=/img/005-logs.png alt=logs></p><h3 id=password-guessing>Password Guessing<a hidden class=anchor aria-hidden=true href=#password-guessing>#</a></h3><p>We can see an example of password gueesing in the log snippet below. IP <code>113.128.246.50</code> attempts to login to <code>HoneyTrap</code> over port 22 using the password <code>adminbigdata</code>:</p><p><img src=/img/005-logs2.png alt="login test attempt"></p><p>After successfully guessing or cracking the <code>HoneyTrap</code> login credentials (username="<code>root</code>" password &ldquo;<code>password</code>") the attacker will see the following fake Ubuntu prompt.</p><p><img src=/img/005-fakelogin.png alt="login test attempt"></p><p>Any attempted commands appear in the logs character by character. An <code>exit</code> command would appear in the logs as:</p><p><img src=/img/005-loginbehavior.png alt="successful login behavior log"></p><h3 id=logging-behaviors>Logging Behaviors<a hidden class=anchor aria-hidden=true href=#logging-behaviors>#</a></h3><p>In another example, the value <code>ssh.exec[]</code> stores the movements of an attacker from source ip <code>71.214.59.235</code> sending exec commands over ssh (without logging in). They send 9 commands before realizing they are in a honeypot, at which point they say hello before disconnecting. Below you can see a screenshot of the logs storing <code>ssh.exec[]</code> values and then the entered commands in plaintext.</p><p><img src=/img/005-hello.png alt="Realize its a honeypot"></p><pre><code>/ip cloud print
ifconfig
uname -a
cat /proc/cpuinfo
ps | grep '[Mm]iner'
ls -la /dev/ttyGSM* /dev/ttyUSB-mod* /var/spool/sms/* /var/log/smsd.log /etc/smsd.conf* /usr/bin/qmuxd /var/qmux_connect_socket /etc/config/simman /dev/modem* /var/config/sms/*
echo Hi | cat -n
</code></pre><h2 id=analysis>Analysis<a hidden class=anchor aria-hidden=true href=#analysis>#</a></h2><p>To collect information from docker, output the logs to a text file and move the text file to another workstation for log ingestion and analysis.</p><pre><code>sudo docker logs CONTAINER_NAME &gt; OUTPUTFILE.txt
</code></pre><p>Here are some commands you can use to manually parse the log for actionable infomation. To understand the parsing context, a log sample is provided:</p><pre><code>SAMPLE LOG:
services &gt; ssh &gt; category=ssh, 
    date=2021-01-24 19:55:03.026780504 +0000 UTC m=+2451.851735112, 
    destination-ip=172.17.0.2, destination-port=8022, sensor=services, 
    source-ip=125.75.150.251, source-port=37014, ssh.password=P@$$woRD!, 
    ssh.sessionid=c06t1500f8ng00eauvog, ssh.username=root, 
    token=c06se0o0f8ng00eauvm0, type=password-authentication
</code></pre><h4 id=ip-source-addresses>IP SOURCE ADDRESSES<a hidden class=anchor aria-hidden=true href=#ip-source-addresses>#</a></h4><pre><code>$egrep -ao 'source-ip=\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b' infile.txt
source-ip=183.230.91.108
source-ip=81.69.20.76
source-ip=71.206.158.143
source-ip=125.75.150.251
source-ip=45.155.205.87
source-ip=45.155.205.87
source-ip=45.155.205.87
source-ip=138.68.24.88
source-ip=71.214.59.235
source-ip=71.214.59.235
source-ip=71.214.59.235
source-ip=71.214.59.235
source-ip=71.214.59.235
source-ip=71.214.59.235
source-ip=71.214.59.235
</code></pre><h4 id=source-ip--command-requests>SOURCE IP & COMMAND REQUESTS<a hidden class=anchor aria-hidden=true href=#source-ip--command-requests>#</a></h4><pre><code>$egrep -ao 'source-ip=\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b|ssh.exec=\[\]string(.*)\&quot;}' infile.txt
source-ip=71.214.59.235
ssh.exec=[]string{&quot;/ip cloud print&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;ifconfig&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;uname -a&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;cat /proc/cpuinfo&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;ps | grep '[Mm]iner'&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;ps -ef | grep '[Mm]iner'&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;ls -la /dev/ttyGSM* /dev/ttyUSB-mod* /var/spool/sms/* /var/log/smsd.log /etc/smsd.conf* /usr/bin/qmuxd /var/qmux_connect_socket /etc/config/simman /dev/modem* /var/config/sms/*&quot;}
source-ip=71.214.59.235
ssh.exec=[]string{&quot;echo Hi | cat -n&quot;}
</code></pre><h4 id=usernamepassword-combinations>USERNAME/PASSWORD COMBINATIONS<a hidden class=anchor aria-hidden=true href=#usernamepassword-combinations>#</a></h4><pre><code>$egrep -ao 'ssh.username=([0-9-]*|[A-Z]*|[a-z]*)|ssh.password=([0-9-]*|[A-Z]*|[a-z]*)' infile.txt
ssh.username=user
ssh.password=adminroute
ssh.username=root
ssh.password=123
ssh.username=root
ssh.password=huangzupei
ssh.username=root
ssh.password=raspberry
ssh.username=pi
ssh.password=raspberryraspberry
ssh.username=root
ssh.password=paxsword
ssh.username=root
ssh.password=passsword
ssh.username=root
ssh.password=password
</code></pre><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>Hosting honeypots on cloud architecture enables security researchers to quickly experiement without endangering local networks. It is not without its own considerations, the researcher should monitor and secure the research workstation and have a plan in the event of compromise. Open-source honeypots are commonly criticized for being easy to detect, evade, and come with security vulnerabilities of their own. In additon to making a plan for the honeypot lifecycle, make a plan for log collection and ingestion to automate log analysis and data visualization.</p><h4 id=opsec>OpSec<a hidden class=anchor aria-hidden=true href=#opsec>#</a></h4><p>Additionally, the default username of the cloud machine will be the username of the gmail address used by GCP. A researcher using <code>firstnameLastname@gmail[dot]com</code> may allow an attacker to identify the first and last name of the researcher. This can be mitigated by adding a new user to the honeypot and removing the old <code>firstnameLastname</code> user. Usernames associated with social media account present similar concerns. Note also at the time of compute instance creation, the hostname set in the networking section defaults to <code>HOSTNAME.REGION.PROJECT_NAME.internal</code> where PROJECT_NAME and hosting region are exposed.</p></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/honeypot/>honeypot</a></li><li><a href=/tags/go/>Go</a></li><li><a href=/tags/ssh/>SSH</a></li><li><a href=/tags/analysis/>analysis</a></li><li><a href=/tags/gcp/>GCP</a></li><li><a href=/tags/tutorial/>tutorial</a></li><li><a href=/tags/honeytrap/>HoneyTrap</a></li><li><a href=/tags/docker/>Docker</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=/>coffeefolia</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.replaceState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>