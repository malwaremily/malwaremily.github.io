---
title: "go-sshoney on GCP honeypot tutorial"
date: 2021-01-22T00:00:03+00:00
weight: 1
aliases: ["/go-ssh-honeypots"]
tags: ["honeypot", "Go", "SSH", "analysis", "GCP", "tutorial"]
author: "Emily Eubanks"
# author: ["Me", "You"] # multiple authors
showToc: true
TocOpen: false
draft: true
hidemeta: false
disableShare: false
cover:
    image: "coffeaarabica1500x500.jpeg" # image path/url
    alt: "Temp Image" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: false # only hide on current single page
comments: false
description: "A one week tour in an e2 Micro GCP Honeypot"
disableHLJS: true # to disable highlightjs
---
## Overview

### Assumptions
* You have go installed locally.
* You are using go-sshoney in a controlled security environment, and NOT a production environment or a shared network.

## Pre-Configuration
Create a secure environment to run the honeypot. I am running my honeypot from a GCP f-micro instance running Ubuntu. As a security  measure instead of a password to login one must use an SSH key. I am logged into our remote GCP f2-micro instance via SSH over port 22. Since I want to log any interactions with the SSH service I use the default port 22 for our fake honeypot service and move the real ssh service to another port. The port number used by the real ssh service can be changed by editing `sshd_config`.

`sudo vim /etc/ssh/sshd_config`

Where the file reads... 

```# What ports, IPs, and protocols we listen for```

...change `Port 22` to `Port 1025` and uncomment `ListenAddress 0.0.0.0` and `ListenAddress ::`.

![sshdconfig](/img/)

Restart the ssh service.

```
sudo systemctl restart ssh
```

Verify SSH daemon is listening on port 1025, you should see the following output.

```
$ ss -an | grep 1025
tcp    LISTEN     0      128       *:1025                  *:*                  
tcp    LISTEN     0      128      :::1025                 :::*
```
Next, we'll update the firewall, `ufw`, to open up our new ssh port. Since we are already accepting connections on port 22 no other related changes are necessary.

```
$ sudo ufw allow 1025/tcp
Rules updated
Rules updated (v6)
```

Now we need to leave the terminal and go to our GCP console and navigate to the firewall for the managed instance. In order to connect to the instance, you'll need to tell GCP that you want to use a different port to connect. Change the "default" rule to allow tcp traffic on port 1025.

![default-allow-ssh rule](/img/)

Now add another rule for `honeypot` traffic on port 22.

![default-allow-1025 rule]()

You should now be able to login from the custom port 1025 and honeypot traffic should be able to communicate out port 22.

## Installation
You'll need to [install docker](https://docs.docker.com/engine/install/ubuntu/) in easy install honeytrap, but after that you can actually run honeytrap staight out of the box from here.

```
sudo docker run -p 22:8022 honeytrap/honeytrap:latest
```

## Analysis


```
sudo docker logs CONTAINER_NAME > OUTPUTFILE.txt
```

## Conclusion
